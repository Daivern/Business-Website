<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product - GrimmLabs</title>
    <link rel="icon" type="image/x-icon" href="logo.png">
    <link rel="stylesheet" href="main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script> <!--Source of Cells-->
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.cells.min.js"></script> <!--Source of Cells--> 
</head>
<body>

    <div id="container2">
        <div id="topnav">
            <a href="home.html"> <img src="logo.png" width="40" height="40"></a>
            <a href="home.html">GrimmLabs</a>
            <a href="learn.html">Learn</a>
            <a href="about.html">About</a>
            <a href="product.html">Product</a>
            
            <div class="cart-btn">
                <span class="nav-icon">
                    <img src="shopping.png" alt="my image">
                </span>
                <div class="cart-items">0</div>
            </div>
          </div>
  
          <div class="cart-overlay">
              <div class="cart">
                  <span class="close-cart">
                      <img src="cancel.png" alt="my image">
                  </span>
                  <h2>Shopping Cart</h2>
                  <div class="cart-content">
                      <!--cart item-->
                     <!-- <div class="cart-item"> -->
                          
                      <!--/div-->
                      <!--cart item end-->
                  </div>
                  <div class="cart-footer">
                      <h3 style="color:rgb(255, 255, 255);">Total : â‚±<span class="cart-total">0</span> <button class="clear-cart banner-btn">Check Out</button> </h3>
                      
                  </div>
              </div>
          </div>


    <!-- PRODUCT SECTION -->
    <main>
        <h1 class="mainTtl"><span>PRODUCTS</span></h1>
        <section class="products" id="shopee">
            <div class="products-center"></div>
        
    </main>

    

    <!--Review-->

    <div class="review" id="Review">
        <h1><span>Customer Review</span></h1>

        <div class="review_box">
            <div class="review_card">

                <div class="review_profile">
                    <img src="image/logo.png">
                </div>

                <div class="review_text">
                    <h2 class="name">Brian Art</h2>

                    <div class="review_icon">
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star-half-stroke"></i>
                    </div>

                    <div class="review_social">
                        <i class="fa-brands fa-facebook-f"></i>
                        <i class="fa-brands fa-instagram"></i>
                        <i class="fa-brands fa-twitter"></i>
                        <i class="fa-brands fa-linkedin-in"></i>
                    </div>

                    <p>
                        Lorem ipsum dolor sit, amet consectetur adipisicing elit. Repellendus quam facere 
                        blanditiis in fugiat tempore necessitatibus aliquid. Id adipisci, rem corrupti 
                        asperiores distinctio delectus quae quia tenetur totam laboriosam quam. Lorem ipsum, 
                        dolor sit amet consectetur adipisicing elit. Dolores soluta ullam ipsa voluptates 
                        repudiandae dignissimos deleniti mollitia eum. Laudantium placeat velit nemo illo 
                        pariatur. Fuga aperiam impedit illo atque repellendus!
                    </p>

                </div>

            </div>

            <div class="review_card">

                <div class="review_profile">
                    <img src="image/logo.png">
                </div>

                <div class="review_text">
                    <h2 class="name">Brian Art</h2>

                    <div class="review_icon">
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star-half-stroke"></i>
                    </div>

                    <div class="review_social">
                        <i class="fa-brands fa-facebook-f"></i>
                        <i class="fa-brands fa-instagram"></i>
                        <i class="fa-brands fa-twitter"></i>
                        <i class="fa-brands fa-linkedin-in"></i>
                    </div>

                    <p>
                        Lorem ipsum dolor sit, amet consectetur adipisicing elit. Repellendus quam facere 
                        blanditiis in fugiat tempore necessitatibus aliquid. Id adipisci, rem corrupti 
                        asperiores distinctio delectus quae quia tenetur totam laboriosam quam. Lorem ipsum, 
                        dolor sit amet consectetur adipisicing elit. Dolores soluta ullam ipsa voluptates 
                        repudiandae dignissimos deleniti mollitia eum. Laudantium placeat velit nemo illo 
                        pariatur. Fuga aperiam impedit illo atque repellendus!
                    </p>

                </div>

            </div>

            <div class="review_card">

                <div class="review_profile">
                    <img src="image/logo.png">
                </div>

                <div class="review_text">
                    <h2 class="name">Brian Art</h2>

                    <div class="review_icon">
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star-half-stroke"></i>
                    </div>

                    <div class="review_social">
                        <i class="fa-brands fa-facebook-f"></i>
                        <i class="fa-brands fa-instagram"></i>
                        <i class="fa-brands fa-twitter"></i>
                        <i class="fa-brands fa-linkedin-in"></i>
                    </div>

                    <p>
                        Lorem ipsum dolor sit, amet consectetur adipisicing elit. Repellendus quam facere 
                        blanditiis in fugiat tempore necessitatibus aliquid. Id adipisci, rem corrupti 
                        asperiores distinctio delectus quae quia tenetur totam laboriosam quam. Lorem ipsum, 
                        dolor sit amet consectetur adipisicing elit. Dolores soluta ullam ipsa voluptates 
                        repudiandae dignissimos deleniti mollitia eum. Laudantium placeat velit nemo illo 
                        pariatur. Fuga aperiam impedit illo atque repellendus!
                    </p>

                </div>

            </div>

            <div class="review_card">

                <div class="review_profile">
                    <img src="image/logo.png">
                </div>

                <div class="review_text">
                    <h2 class="name">Brian Art</h2>

                    <div class="review_icon">
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star-half-stroke"></i>
                    </div>

                    <div class="review_social">
                        <i class="fa-brands fa-facebook-f"></i>
                        <i class="fa-brands fa-instagram"></i>
                        <i class="fa-brands fa-twitter"></i>
                        <i class="fa-brands fa-linkedin-in"></i>
                    </div>

                    <p>
                        Lorem ipsum dolor sit, amet consectetur adipisicing elit. Repellendus quam facere 
                        blanditiis in fugiat tempore necessitatibus aliquid. Id adipisci, rem corrupti 
                        asperiores distinctio delectus quae quia tenetur totam laboriosam quam. Lorem ipsum, 
                        dolor sit amet consectetur adipisicing elit. Dolores soluta ullam ipsa voluptates 
                        repudiandae dignissimos deleniti mollitia eum. Laudantium placeat velit nemo illo 
                        pariatur. Fuga aperiam impedit illo atque repellendus!
                    </p>

                </div>

            </div>

        </div>

    </div>
    <footer>
        <div class="footer-content">
            <h3>GrimmLabs</h3>
            Home of Exotic Pets in Philippines - Breeder, Distributor
            <ul class="socials">
                <li><a href="https://www.facebook.com/GrimmLabs30"><i class="fa-brands fa-facebook-f"></i></a></li>
             </ul>
        </div>

        <div class="footer-bottom">
            <p>copyright &copy;2023 <a href="#">GrimmLabs</a>  </p>
            <div class="footer-menu">
                <ul class="f-menu">
                   <li><a href="home.html">Home</a></li>
                   <li><a href="learn.html">Learn</a></li>
                   <li><a href="about.html">About</a></li>
                   <li><a href="product.html">Product</a></li>
                </ul>
               </div>
         </div>
    </footer>
</div>

<script>
    //variables
const cartBtn = document.querySelector(".cart-btn");
const closeCartBtn = document.querySelector(".close-cart");
const clearCartBtn = document.querySelector(".clear-cart");
const cartDOM = document.querySelector(".cart");
const cartOverlay = document.querySelector(".cart-overlay");
const cartItems = document.querySelector(".cart-items");
const cartTotal = document.querySelector(".cart-total");
const cartContent = document.querySelector(".cart-content");
const productsDOM = document.querySelector(".products-center");

//cart 
let cart = [];
//buttons
let buttonsDOM = [];

//get product
class Products{
async getProducts(){
    try{
        let result = await fetch('product2.json')
        let data = await result.json();

        let products = data.items;
        products = products.map(item =>{
            const {title, price} = item.fields;
            const {details} = item.fields;
            const {sale} = item.fields;
            const {percent} = item.fields;
            const {id} = item.sys;
            const image = item.fields.image.fields.file.url;
            return {title, price,id,image,details,sale,percent}
        })
        return products
    } catch (error){
        console.log(error);
    }
}
}

// for ui/displaying product
class UI {
displayProducts(products){
    let result = "";
    products.forEach(product => {
        result +=`
        <!-- single product -->
        <article class="product">
            <div class="img-container">
                <img 
                src=${product.image}
                alt="product" 
                class="product-img">
                <button class="bag-btn" data-id=${product.id}>
                    <i class="fas fa-shopping-cart"></i>
                    Order Now
                </button>
            </div>
            <h3>${product.title}</h3>
            <h3>${product.details}</h3>
            <h2>â‚±${product.price}</h2>
            
            
        </article>
        <!-- end of single product -->
        `;
    });
    productsDOM.innerHTML = result;
}
getBagButtons(){
    const buttons = [...document.querySelectorAll(".bag-btn")];
    buttonsDOM = buttons;
    buttons.forEach(button => {
        let id = button.dataset.id;
        let inCart = cart.find(item => item.id === id);
        if(inCart){
            button.innerText = "Ordered";
            button.disabled = true;
        }
        button.addEventListener("click",(event)=>{
            event.target.innerText = "Ordered";
            event.target.disabled = true;

            //  gets product from products
            let cartItem = {...Storage.getProduct(id), amount:1};

            //  also adds product to cart
            cart = [...cart,cartItem];

            //  then save cart in localstorage
            Storage.saveCart(cart);

            //  set cart values
            this.setCartValues(cart);

            //  display/add cart item
            this.addCartItem(cartItem);

            //  finally show cart
            this.showCart();
        });
    });
}
setCartValues(cart){
    let tempTotal = 0;
    let itemsTotal = 0;
    cart.map(item =>{
        tempTotal+= item.price * item.amount;
        itemsTotal += item.amount;
    });
    cartTotal.innerText = parseFloat(tempTotal.toFixed(2));
    cartItems.innerText = itemsTotal;
}
addCartItem(item){
    const div = document.createElement('div');
    div.classList.add('cart-item');
    div.innerHTML = `
    <img src=${item.image} alt="product">
         <div>
            <h4>${item.title}</h4>
            <h5> â‚±${item.price}</h5>
            <span class="remove-item" data-id=${item.id}>Remove</span>
        </div>
        <div>
            <i class="fa-solid fa-sort-up" style="color: #ffffff;" data-id=${item.id}></i>
            <p style="color: white;" class="item-amount">${item.amount}</p>
            <i class="fa-solid fa-sort-down" style="color: #ffffff;" data-id=${item.id}></i>
        </div>       
    `;
    cartContent.appendChild(div);

}
showCart(){
    cartOverlay.classList.add('transparentBcg');
    cartDOM.classList.add('showCart');
}
setupAPP(){
    cart = Storage.getCart();
    this.setCartValues(cart);
    this.populateCart(cart);
    cartBtn.addEventListener('click',this.showCart);
    closeCartBtn.addEventListener('click',this.hideCart);
}
populateCart(cart){
    cart.forEach(item => this.addCartItem(item));
}
hideCart(){
    cartOverlay.classList.remove('transparentBcg');
    cartDOM.classList.remove('showCart');
}
cartLogic(){
    clearCartBtn.addEventListener('click', ()=>{
        this.clearCart();
    });
    cartContent.addEventListener('click', event => {
        if(event.target.classList.contains('remove-item')){
            let removeItem = event.target;
            let id = removeItem.dataset.id;
            cartContent.removeChild(removeItem.parentElement.parentElement);
            this.removeItem(id);
        }
        else if (event.target.classList.contains("fa-sort-up")){
            let addAmount = event.target;
            let id = addAmount.dataset.id;
            let tempItem = cart.find(item => item.id===id);
            tempItem.amount = tempItem.amount + 1;
            Storage.saveCart(cart);
            this.setCartValues(cart);
            addAmount.nextElementSibling.innerText = tempItem.amount;
        }
        else if (event.target.classList.contains("fa-sort-down")){
            let lowerAmount = event.target;
            let id = lowerAmount.dataset.id;
            let tempItem = cart.find(item => item.id===id);
            tempItem.amount = tempItem.amount - 1;
            if(tempItem.amount > 0){
                Storage.saveCart(cart);
                this.setCartValues(cart);
                lowerAmount.previousElementSibling.innerText = tempItem.amount;
            }
            else{
                cartContent.removeChild(lowerAmount.parentElement.parentElement);
                this.removeItem(id);
            }
        }
    });
}
clearCart(){
    let cartItems = cart.map(item => item.id);
    
    alert("Redirecting to Check Out");
    window.location.href = "checkout.html";

    while(cartContent.children.length>0){
        cartContent.removeChild(cartContent.children[0]);
    }
    this.hideCart();
}
removeItem(id){
    cart = cart.filter(item => item.id !==id);
    this.setCartValues(cart);
    Storage.saveCart(cart);
    let button = this.getSingleButton(id);
    button.disabled = false;
    button.innerHTML = `<i class="fas fa-shopping-cart"></i> Add to Cart`;
}
getSingleButton(id){
    return buttonsDOM.find(button => button.dataset.id === id);
}
}

//local storage
class Storage {
static saveProducts(products){
    localStorage.setItem("products",JSON.stringify(products));
}
static getProduct(id){
    let products = JSON.parse(localStorage.getItem('products'));
    return products.find(product => product.id === id);
}
static saveCart(){
    localStorage.setItem('cart',JSON.stringify(cart));
}
static getCart(){
    return localStorage.getItem('cart')?JSON.parse(localStorage.getItem('cart')):[]
}
}

document.addEventListener("DOMContentLoaded", ()=>{
const ui = new UI();
const products = new Products();
// setup app
ui.setupAPP();
//get all products
products.getProducts().then(products => {
    ui.displayProducts(products);
    Storage.saveProducts(products);
}).then(()=>{
    ui.getBagButtons();
    ui.cartLogic();
});
});
</script>

<script>
    VANTA.CELLS({
    el: "#container2",
    mouseControls: true,
    touchControls: true,
    gyroControls: false,
    minHeight: 20000.00,
    minWidth: 200.00,
    scale: 2.00,
    size: 1.00,
    speed: 5.00
    });
    </script>
    
</body>
</html>